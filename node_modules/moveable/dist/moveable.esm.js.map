{"version":3,"file":"moveable.esm.js","sources":["../src/InnerMoveable.tsx","../src/consts.ts","../src/MoveableManager.tsx","../src/Moveable.tsx","../src/utils.ts"],"sourcesContent":["import * as React from \"react\";\nimport { createPortal } from \"react-dom\";\nimport Moveable, { MoveableProps } from \"react-moveable\";\nimport { ref } from \"framework-utils\";\n\nexport default class InnerMoveable extends React.Component<any> {\n    public state: any = {};\n    public moveable!: Moveable;\n    constructor(props: any) {\n        super(props);\n        this.state = this.props;\n    }\n    public render() {\n        return createPortal(<Moveable ref={ref(this, \"moveable\")} {...this.state} />, this.state.parentElement);\n    }\n}\n","import { MOVEABLE_PROPS_MAP } from \"react-compat-moveable\";\nimport { MOVEABLE_PROPS, MOVEABLE_METHODS, MOVEABLE_EVENTS } from \"react-moveable\";\n\nexport const PROPERTIES: string[] = MOVEABLE_PROPS;\nexport const METHODS: string[] = MOVEABLE_METHODS;\nexport const EVENTS: string[] = MOVEABLE_EVENTS;\nexport const PROPS_MAP: Record<string, any> = MOVEABLE_PROPS_MAP;\n","import { ref, Properties } from \"framework-utils\";\nimport * as React from \"react\";\nimport { render } from \"react-dom\";\nimport InnerMoveable from \"./InnerMoveable\";\nimport {\n    MoveableInterface,\n    MoveableOptions, MoveableProperties,\n} from \"react-moveable/types\";\nimport { camelize, isArray } from \"@daybrush/utils\";\nimport { MoveableEventsParameters } from \"./types\";\nimport { PROPERTIES, EVENTS, METHODS } from \"./consts\";\nimport EventEmitter from \"@scena/event-emitter\";\n/**\n * Moveable is Draggable! Resizable! Scalable! Rotatable!\n * @sort 1\n * @alias Moveable\n * @extends EventEmitter\n */\n@Properties(METHODS, (prototype, property) => {\n    if (prototype[property]) {\n        return;\n    }\n    prototype[property] = function(...args: any[]) {\n        const self = this.getMoveable();\n\n        if (!self || !self[property]) {\n            return;\n        }\n        return self[property](...args);\n    };\n})\n@Properties(PROPERTIES, (prototype, property) => {\n    Object.defineProperty(prototype, property, {\n        get() {\n            return this.getMoveable().props[property];\n        },\n        set(value) {\n            this.setState({\n                [property]: value,\n            });\n        },\n        enumerable: true,\n        configurable: true,\n    });\n})\nclass MoveableManager extends EventEmitter<MoveableEventsParameters> {\n    private innerMoveable!: InnerMoveable | null;\n    private tempElement: HTMLElement | null = document.createElement(\"div\");\n\n    /**\n     *\n     */\n    constructor(parentElement: HTMLElement | SVGElement, options: MoveableOptions = {}) {\n        super();\n        const nextOptions = { ...options };\n\n        const events: any = {};\n\n        EVENTS.forEach(name => {\n            events[camelize(`on ${name}`)] = (e: any) => this.trigger<any>(name, e);\n        });\n\n        render(\n            <InnerMoveable\n                ref={ref(this, \"innerMoveable\")}\n                parentElement={parentElement}\n                {...nextOptions}\n                {...events}\n            />,\n            this.tempElement,\n        );\n        const target = nextOptions.target!;\n        if (isArray(target) && target.length > 1) {\n            this.updateRect();\n        }\n    }\n    public setState(state: Partial<MoveableOptions>, callback?: () => any) {\n        this.innerMoveable!.setState(state, callback);\n    }\n    public destroy() {\n        render(null as any, this.tempElement!);\n        this.off();\n        this.tempElement = null;\n        this.innerMoveable = null;\n    }\n    private getMoveable() {\n        return this.innerMoveable!.moveable;\n    }\n}\n\ninterface MoveableManager extends MoveableInterface, MoveableProperties {\n}\n\nexport default MoveableManager;\n","import MoveableManager from \"./MoveableManager\";\n\nexport default class Moveable extends MoveableManager {}\n","import { Able, DefaultProps } from \"react-moveable/types\";\nimport { getElementInfo as getElementInfoFunction, makeAble as makeAbleFunction } from \"react-moveable\";\n\nexport function getElementInfo(\n    target: SVGElement | HTMLElement,\n    container?: SVGElement | HTMLElement | null,\n    rootContainer?: SVGElement | HTMLElement | null | undefined,\n) {\n    return getElementInfoFunction(target, container, rootContainer);\n};\nexport function makeAble<\n    Name extends string,\n    AbleObject extends Partial<Able<any, any>>,\n    Props extends DefaultProps<Name, AbleObject>,\n>(name: Name, able: AbleObject) {\n    return makeAbleFunction<Name, AbleObject, Props>(name, able);\n}\n"],"names":["__extends","props","_super","_this","state","createPortal","React","Moveable","ref","parentElement","PROPERTIES","MOVEABLE_PROPS","METHODS","MOVEABLE_METHODS","EVENTS","MOVEABLE_EVENTS","PROPS_MAP","MOVEABLE_PROPS_MAP","options","document","createElement","nextOptions","events","forEach","name","camelize","e","trigger","render","InnerMoveable","tempElement","target","isArray","length","updateRect","callback","innerMoveable","setState","off","moveable","MoveableManager","Properties","prototype","property","_i","args","self","getMoveable","Object","defineProperty","get","set","value","_a","enumerable","configurable","EventEmitter","getElementInfo","container","rootContainer","getElementInfoFunction","makeAble","able","makeAbleFunction"],"mappings":"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"}